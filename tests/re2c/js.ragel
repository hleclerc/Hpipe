/*
 * A C++ scanner. Uses the longest match construction.
 * << <= <<= >> >= >>= are left out since angle brackets are used in templates.
 */

#include <string.h>
#include <stdlib.h>
#include <iostream>
#include <ctime>

/* EOF char used to flush out that last token. This should be a whitespace
 * token. */

#define LAST_CHAR 0

using std::cerr;
using std::cout;
using std::cin;
using std::endl;

static int line = 1, col = 1;
static char *ts, *te;
static int act, have = 0;
static int cs;

%%{
	machine Scanner; 
	write data nofinal;

	# Floating literals.
	fract_const = digit* '.' digit+ | digit+ '.';
	exponent = [eE] [+\-]? digit+;
	float_suffix = [flFL];

	c_comment := 
		any* :>> '*/'
		@{ fgoto main; };

	main := |*

	# Single and double literals.
	( 'L'? "'" ( [^'\\\n] | /\\./ )* "'" ) 
		{ ++num; };
	( 'L'? '"' ( [^"\\\n] | /\\./ )* '"' ) 
		{ ++num; };

	# Identifiers
	( [a-zA-Z_] [a-zA-Z0-9_]* ) 
		{ ++num; };

	# Floating literals.
	( fract_const exponent? float_suffix? | digit+ exponent float_suffix? ) 
		{ ++num; };
	
	# Integer decimal. Leading part buffered by float.
	( ( '0' | [1-9] [0-9]* ) [ulUL]{0,3} ) 
		{ ++num; };

	# Integer octal. Leading part buffered by float.
	( '0' [0-9]+ [ulUL]{0,2} ) 
		{ ++num; };

	# Integer hex. Leading 0 buffered by float.
	( '0' ( 'x' [0-9a-fA-F]+ [ulUL]{0,2} ) ) 
		{ ++num; };

	# Only buffer the second item, first buffered by symbol. */
	'>>>=' { ++num; };

	'>>>'  { ++num; };
	'>>='  { ++num; };
	'==='  { ++num; }; 
	'<<='  { ++num; };
	'**='  { ++num; };
	'...'  { ++num; }; 
	'!=='  { ++num; }; 

	'||'   { ++num; }; 
	'|='   { ++num; };
	'>>'   { ++num; };
	'>='   { ++punct; };
	'=>'   { ++num; }; 
	'=='   { ++num; };
	'<='   { ++num; };
	'<<'   { ++num; };
	'+='   { ++num; }; 
	'++'   { ++num; }; 
	'^='   { ++num; };
	'%='   { ++num; };
	'&='   { ++num; };
	'&&'   { ++num; }; 
	'/='   { ++num; }; 
	'*='   { ++num; };
	'**'   { ++num; };
	'!='   { ++num; };
	'-='   { ++num; }; 
	'--'   { ++num; }; 

	'~'    { ++num; };
	'|'    { ++num; };
	'>'    { ++num; };
	'='    { ++num; };
	'<'    { ++num; };
	'+'    { ++num; };
	'^'    { ++num; };
	'%'    { ++num; };
	'&'    { ++num; };
	'/'    { ++num; };
	'*'    { ++num; };
	'}'    { ++num; };
	'{'    { ++num; };
	']'    { ++num; };
	'['    { ++num; };
	')'    { ++num; };
	'('    { ++num; };
	'.'    { ++num; };
	'?'    { ++num; };
	'!'    { ++num; };
	':'    { ++num; };
	';'    { ++num; };
	','    { ++num; };
	'-'    { ++num; };

	# Comments and whitespace.
	'/*' { fgoto c_comment; };
	'//' [^\n]* '\n';
	any;

	*|;
}%%

int main() {
    static char buf[] = { 108,101,116,32,118,97,114,105,97,110,116,115,32,61,32,91,93,44,32,105,109,103,95,110,97,109,101,115,32,61,32,91,93,59,10,102,111,114,40,32,99,111,110,115,116,32,97,114,103,32,111,102,32,112,114,111,99,101,115,115,46,97,114,103,118,46,115,108,105,99,101,40,32,50,32,41,32,41,32,123,10,32,32,32,32,105,102,32,40,32,97,114,103,46,115,116,97,114,116,115,87,105,116,104,40,32,34,45,45,34,32,41,32,41,32,123,10,32,32,32,32,32,32,32,32,99,111,110,115,116,32,105,110,101,32,61,32,97,114,103,46,105,110,100,101,120,79,102,40,32,34,61,34,32,41,59,10,32,32,32,32,32,32,32,32,105,102,32,40,32,105,110,101,32,62,61,32,48,32,41,32,47,47,32,38,38,32,118,110,46,105,110,100,101,120,79,102,40,32,97,114,103,46,115,117,98,115,116,114,105,110,103,40,32,50,44,32,105,110,101,32,41,32,41,32,62,61,32,48,10,32,32,32,32,32,32,32,32,32,32,32,32,118,97,114,105,97,110,116,115,46,112,117,115,104,40,32,123,32,110,97,109,101,58,32,97,114,103,46,115,117,98,115,116,114,105,110,103,40,32,50,44,32,105,110,101,32,45,32,49,32,41,44,32,118,97,108,117,101,115,58,32,97,114,103,46,115,117,98,115,116,114,105,110,103,40,32,105,110,101,32,43,32,49,32,41,46,115,112,108,105,116,40,32,34,44,34,32,41,32,125,32,41,59,10,32,32,32,32,125,32,101,108,115,101,10,32,32,32,32,32,32,32,32,105,109,103,95,110,97,109,101,115,46,112,117,115,104,40,32,97,114,103,32,41,59,10,125,10,10,102,117,110,99,116,105,111,110,32,112,114,101,102,105,120,40,32,101,120,116,32,41,32,123,10,32,32,32,32,115,119,105,116,99,104,32,40,32,101,120,116,46,116,111,76,111,119,101,114,67,97,115,101,40,41,32,41,32,123,10,32,32,32,32,32,32,32,32,99,97,115,101,32,34,46,106,112,101,103,34,58,10,32,32,32,32,32,32,32,32,32,32,32,32,114,101,116,117,114,110,32,96,100,97,116,97,58,105,109,97,103,101,47,106,112,103,59,98,97,115,101,54,52,44,96,59,10,32,32,32,32,32,32,32,32,100,101,102,97,117,108,116,58,10,32,32,32,32,32,32,32,32,32,32,32,32,114,101,116,117,114,110,32,96,100,97,116,97,58,105,109,97,103,101,47,36,123,32,101,120,116,46,115,108,105,99,101,40,32,49,32,41,32,125,59,98,97,115,101,54,52,44,96,59,10,32,32,32,32,125,10,125,10,10,102,117,110,99,116,105,111,110,32,101,120,112,108,111,114,101,95,118,97,114,105,97,110,116,115,40,32,108,115,116,44,32,118,97,114,95,110,97,109,101,44,32,105,109,103,95,110,97,109,101,32,41,32,123,10,32,32,32,32,105,102,32,40,32,108,115,116,46,108,101,110,103,116,104,32,61,61,32,118,97,114,105,97,110,116,115,46,108,101,110,103,116,104,32,41,32,123,10,32,32,32,32,32,32,32,32,105,102,32,40,32,108,115,116,46,108,101,110,103,116,104,32,61,61,32,48,32,41,10,32,32,32,32,32,32,32,32,32,32,32,32,114,101,116,117,114,110,32,99,111,110,115,111,108,101,46,108,111,103,40,32,96,109,111,100,117,108,101,46,101,120,112,111,114,116,115,36,123,32,118,97,114,95,110,97,109,101,46,108,101,110,103,116,104,32,63,32,34,46,34,32,43,32,118,97,114,95,110,97,109,101,32,58,32,34,34,32,125,32,61,32,34,36,123,32,112,114,101,102,105,120,40,32,112,97,116,104,46,101,120,116,110,97,109,101,40,32,105,109,103,95,110,97,109,101,32,41,32,41,32,125,36,123,32,102,115,46,114,101,97,100,70,105,108,101,83,121,110,99,40,32,105,109,103,95,110,97,109,101,32,41,46,116,111,83,116,114,105,110,103,40,32,39,98,97,115,101,54,52,39,32,41,32,125,34,59,96,32,41,59,10,32,32,32,32,32,32,32,32,47,47,32,99,104,101,99,107,32,105,109,97,103,101,32,109,97,103,105,99,107,32,105,115,32,112,114,101,115,101,110,116,10,32,32,32,32,32,32,32,32,99,111,110,115,116,32,114,112,32,61,32,99,112,46,115,112,97,119,110,83,121,110,99,40,32,34,110,115,109,97,107,101,34,44,32,91,32,34,112,114,101,114,101,113,117,34,44,32,34,99,111,110,118,101,114,116,34,32,93,44,32,123,32,115,116,100,105,111,58,32,91,32,48,44,32,50,44,32,50,32,93,32,125,32,41,59,10,32,32,32,32,32,32,32,32,105,102,32,40,32,114,112,46,101,114,114,111,114,32,124,124,32,114,112,46,115,116,97,116,117,115,32,41,10,32,32,32,32,32,32,32,32,32,32,32,32,112,114,111,99,101,115,115,46,101,120,105,116,40,32,49,32,41,59,10,32,32,32,32,32,32,32,32,47,47,32,108,97,117,110,99,104,32,99,111,110,118,101,114,116,10,32,32,32,32,32,32,32,32,114,101,116,117,114,110,32,116,109,112,46,102,105,108,101,40,32,123,125,44,32,40,32,101,114,114,44,32,116,109,112,95,110,97,109,101,44,32,102,100,44,32,99,108,101,97,110,117,112,67,97,108,108,98,97,99,107,32,41,32,61,62,32,123,10,32,32,32,32,32,32,32,32,32,32,32,32,108,101,116,32,99,111,110,118,101,114,116,95,97,114,103,115,32,61,32,91,32,105,109,103,95,110,97,109,101,32,93,59,10,32,32,32,32,32,32,32,32,32,32,32,32,102,111,114,40,32,99,111,110,115,116,32,118,32,111,102,32,108,115,116,32,41,32,123,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,105,102,32,40,32,118,46,118,97,108,117,101,46,108,101,110,103,116,104,32,41,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,99,111,110,118,101,114,116,95,97,114,103,115,46,112,117,115,104,40,32,34,45,34,32,43,32,118,46,110,97,109,101,44,32,118,46,118,97,108,117,101,32,41,59,10,32,32,32,32,32,32,32,32,32,32,32,32,125,10,32,32,32,32,32,32,32,32,32,32,32,32,99,111,110,118,101,114,116,95,97,114,103,115,46,112,117,115,104,40,32,116,109,112,95,110,97,109,101,32,41,59,10,10,32,32,32,32,32,32,32,32,32,32,32,32,99,111,110,115,116,32,114,112,32,61,32,99,112,46,115,112,97,119,110,40,32,34,99,111,110,118,101,114,116,34,44,32,99,111,110,118,101,114,116,95,97,114,103,115,44,32,123,32,115,116,100,105,111,58,32,91,32,48,44,32,50,44,32,50,32,93,32,125,32,41,59,10,32,32,32,32,32,32,32,32,32,32,32,32,114,112,46,111,110,40,32,39,101,114,114,111,114,39,44,32,101,114,114,32,61,62,32,123,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,99,108,101,97,110,117,112,67,97,108,108,98,97,99,107,40,41,59,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,112,114,111,99,101,115,115,46,101,120,105,116,40,32,49,32,41,59,10,32,32,32,32,32,32,32,32,32,32,32,32,125,32,41,59,10,32,32,32,32,32,32,32,32,32,32,32,32,114,112,46,111,110,40,32,39,99,108,111,115,101,39,44,32,99,111,100,101,32,61,62,32,123,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,105,102,32,40,32,99,111,100,101,32,41,32,123,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,99,108,101,97,110,117,112,67,97,108,108,98,97,99,107,40,41,59,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,112,114,111,99,101,115,115,46,101,120,105,116,40,32,49,32,41,59,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,125,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,99,111,110,115,111,108,101,46,108,111,103,40,32,96,109,111,100,117,108,101,46,101,120,112,111,114,116,115,46,36,123,32,118,97,114,95,110,97,109,101,32,125,32,61,32,34,36,123,32,112,114,101,102,105,120,40,32,112,97,116,104,46,101,120,116,110,97,109,101,40,32,105,109,103,95,110,97,109,101,32,41,32,41,32,125,36,123,32,102,115,46,114,101,97,100,70,105,108,101,83,121,110,99,40,32,116,109,112,95,110,97,109,101,32,41,46,116,111,83,116,114,105,110,103,40,32,39,98,97,115,101,54,52,39,32,41,32,125,34,59,96,32,41,59,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,99,108,101,97,110,117,112,67,97,108,108,98,97,99,107,40,41,59,10,32,32,32,32,32,32,32,32,32,32,32,32,125,32,41,59,10,32,32,32,32,32,32,32,32,125,32,41,59,10,32,32,32,32,125,10,32,32,32,32,102,111,114,40,32,99,111,110,115,116,32,118,97,108,117,101,32,111,102,32,118,97,114,105,97,110,116,115,91,32,108,115,116,46,108,101,110,103,116,104,32,93,46,118,97,108,117,101,115,32,41,32,123,10,32,32,32,32,32,32,32,32,101,120,112,108,111,114,101,95,118,97,114,105,97,110,116,115,40,32,91,32,46,46,46,108,115,116,44,32,123,32,110,97,109,101,58,32,118,97,114,105,97,110,116,115,91,32,108,115,116,46,108,101,110,103,116,104,32,93,46,110,97,109,101,44,32,118,97,108,117,101,32,125,32,93,44,32,118,97,114,95,110,97,109,101,32,43,32,40,10,32,32,32,32,32,32,32,32,32,32,32,32,118,97,108,117,101,46,108,101,110,103,116,104,32,63,32,40,32,118,97,114,95,110,97,109,101,46,108,101,110,103,116,104,32,63,32,34,95,95,34,32,58,32,34,34,32,41,32,43,96,36,123,32,118,97,114,105,97,110,116,115,91,32,108,115,116,46,108,101,110,103,116,104,32,93,46,110,97,109,101,32,125,95,36,123,32,118,97,108,117,101,32,125,96,32,58,32,39,39,10,32,32,32,32,32,32,32,32,41,44,32,105,109,103,95,110,97,109,101,32,41,59,10,32,32,32,32,125,10,125,10,10,102,111,114,40,32,99,111,110,115,116,32,105,109,103,95,110,97,109,101,32,111,102,32,105,109,103,95,110,97,109,101,115,32,41,10,32,32,32,32,101,120,112,108,111,114,101,95,118,97,114,105,97,110,116,115,40,32,91,93,44,32,105,109,103,95,110,97,109,101,115,46,108,101,110,103,116,104,32,62,32,49,32,63,32,101,110,99,111,100,101,85,82,73,67,111,109,112,111,110,101,110,116,40,32,112,97,116,104,46,98,97,115,101,110,97,109,101,40,32,105,109,103,95,110,97,109,101,44,32,112,97,116,104,46,101,120,116,110,97,109,101,40,32,105,109,103,95,110,97,109,101,32,41,32,41,32,41,32,58,32,34,34,44,32,105,109,103,95,110,97,109,101,32,41,59, 0 };

    auto t0 = std::clock();
	unsigned num = 0, punct = 0;
	int len = strlen( buf );
    for( unsigned var = 0; var < 1000000; ++var ) {
		%% write init;

		/* Do the first read. */
		char *p = buf, *pe = p + len;
		char *eof = 0;

		%% write exec;
    }
    auto t1 = std::clock();

    // std::cout << " -> " << err << " " << num << " " << punctuator << " " << name << " " << sp << std::endl;
    std::cout << " -> " << num << " " << punct << std::endl;
    std::cout << " -> " << double( t1 - t0 ) / CLOCKS_PER_SEC << std::endl;

	return 0;
}
 